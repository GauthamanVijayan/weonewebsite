<section class="weone-sponsor-hero">
    <div class="weone-hero-container">
        <div class="weone-hero-content" appScrollAnimate>
            <div class="weone-hero-badge">
                <span class="weone-badge-dot"></span>
                <span i18n>Be a Nation Builder</span>
            </div>
            <h1 class="weone-hero-title" i18n="Sponsor page hero title">
                Sponsor Kerala's<br />
                Digital Empowerment
            </h1>
            <p class="weone-hero-subtitle" i18n>
                From Digital Literacy to Digital Empowerment. Join the WeOne
                Movement and create lasting impact across communities.
            </p>
            <div class="weone-hero-stats">
                <div class="weone-stat-item">
                    <span class="weone-stat-number">₹15,000</span>
                    <span class="weone-stat-label" i18n
                        >Per Correspondent/Month</span
                    >
                </div>
                <div class="weone-stat-item">
                    <span class="weone-stat-number">3X</span>
                    <span class="weone-stat-label" i18n
                        >Wallet Bonus Value</span
                    >
                </div>
                <div class="weone-stat-item">
                    <span class="weone-stat-number">100%</span>
                    <span class="weone-stat-label" i18n>Digital Coverage</span>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="weone-section weone-intro-section">
    <div class="weone-container">
        <div class="weone-intro-content" appScrollAnimate>
            <p class="weone-intro-text" i18n>
                <strong>WeOne</strong>, developed by
                <strong>Intia (OPC) Private Limited</strong> in partnership with
                the <strong>Local Self Government Department (LSGD)</strong>,
                Government of Kerala, is more than a social media platform — it
                is a verified social development ecosystem designed to connect
                every household, every ward, and every community through
                transparent, technology-driven engagement.
            </p>
            <p class="weone-intro-text" i18n>
                Your sponsorship directly supports
                <strong>Digital India</strong>,
                <strong>Atmanirbhar Bharat</strong>, and Kerala's
                <strong>Smart Governance Vision</strong>
                — while creating livelihood, awareness, and digital inclusion at
                the grassroots level.
            </p>
        </div>
    </div>
</section>

<section class="weone-section weone-why-matters-section">
    <div class="weone-container">
        <div class="weone-section-header" appScrollAnimate>
            <h2 class="weone-section-title" i18n>
                Why Your Sponsorship Matters
            </h2>
            <p class="weone-section-subtitle" i18n>
                This is not a donation — it's an investment in India's digital
                future.
            </p>
        </div>

        <div class="weone-benefits-grid">
            <div
                class="weone-benefit-card"
                appScrollAnimate
                [animationDelay]="0"
            >
                <div class="weone-benefit-icon">
                    <i class="pi pi-briefcase"></i>
                </div>
                <h3 i18n>Creates Local Employment</h3>
                <p i18n>
                    Trained youth and women become WeOne Correspondents, earning
                    dignified livelihoods while serving their communities.
                </p>
            </div>
            <div
                class="weone-benefit-card"
                appScrollAnimate
                [animationDelay]="100"
            >
                <div class="weone-benefit-icon">
                    <i class="pi pi-users"></i>
                </div>
                <h3 i18n>Connects Communities</h3>
                <p i18n>
                    Hundreds of households gain access to verified civic
                    platforms, closing the information gap at the grassroots
                    level.
                </p>
            </div>
            <div
                class="weone-benefit-card"
                appScrollAnimate
                [animationDelay]="200"
            >
                <div class="weone-benefit-icon">
                    <i class="pi pi-comments"></i>
                </div>
                <h3 i18n>Enables Communication</h3>
                <p i18n>
                    Transparent, two-way dialogue between citizens and local
                    government bodies becomes a reality.
                </p>
            </div>
            <div
                class="weone-benefit-card"
                appScrollAnimate
                [animationDelay]="300"
            >
                <div class="weone-benefit-icon"><i class="pi pi-flag"></i></div>
                <h3 i18n>Strengthens Digital India</h3>
                <p i18n>
                    Direct support to the national mission through inclusive,
                    community-driven digital participation.
                </p>
            </div>
        </div>
    </div>
</section>

<section class="weone-section weone-bonus-section">
    <div class="weone-container">
        <div class="weone-bonus-highlight" appScrollAnimate>
            <div class="weone-bonus-icon"><i class="pi pi-gift"></i></div>
            <div class="weone-bonus-content">
                <h3 i18n>Your Sponsorship Multiplies in Value</h3>
                <p i18n>
                    Receive <strong>3X promotional value</strong> in your WeOne
                    App Wallet. Sponsor ₹15,000 and get
                    <strong>₹45,000</strong> in advertising credits to promote
                    your brand, products, or services across Kerala's digital
                    network.
                </p>
                <ul class="weone-bonus-list">
                    <li i18n>
                        <i class="pi pi-check-circle"></i> Nationwide
                        advertising campaigns
                    </li>
                    <li i18n>
                        <i class="pi pi-check-circle"></i> Targeted audience by
                        district and ward
                    </li>
                    <li i18n>
                        <i class="pi pi-check-circle"></i> WeOne Privilege
                        Partner for Life
                    </li>
                    <li i18n>
                        <i class="pi pi-check-circle"></i> Priority visibility
                        in digital campaigns
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>

<section class="weone-section weone-tool-section">
    <div class="weone-container">
        <div class="weone-tool-layout">
            <div class="weone-tool-main">
                <div class="weone-section-header-small" appScrollAnimate>
                    <h3 i18n>Select Wards to Sponsor</h3>
                    <p i18n>
                        Choose a district and local body to view available
                        wards. Each correspondent requires ₹15,000 + 18% GST per
                        month.
                    </p>
                </div>

                <div class="weone-filter-section" appScrollAnimate>
                    <div class="weone-filter-controls">
                        <!-- STATE-LEVEL SELECTION (NEW) -->
                        <div class="weone-filter-item weone-state-selector">
                            <label i18n>Select Entire State</label>

                            @if (bulkSelectionLevel() === 'state') {
                                <div class="weone-selection-active">
                                    <div class="weone-selection-info">
                                        <i class="pi pi-check-circle"></i>
                                        <span
                                            >{{ displayedWardCount() }} wards
                                            selected</span
                                        >
                                    </div>
                                    <div class="weone-selection-actions">
                                        <p-button
                                            label="Add to Cart"
                                            icon="pi pi-shopping-cart"
                                            severity="success"
                                            size="small"
                                            (onClick)="openBulkSponsorDialog()"
                                        />
                                        <p-button
                                            label="Clear"
                                            icon="pi pi-times"
                                            severity="danger"
                                            size="small"
                                            [outlined]="true"
                                            (onClick)="clearStateSelection()"
                                        />
                                    </div>
                                </div>
                            } @else {
                                <p-button
                                    label="Select All Wards in Kerala"
                                    i18n-label
                                    icon="pi pi-map"
                                    severity="success"
                                    [style]="{ width: '100%' }"
                                    [disabled]="areDropdownsDisabled()"
                                    (onClick)="selectAllWardsInState()"
                                />
                            }
                        </div>

                        <!-- DIVIDER -->
                        <div class="weone-filter-divider">
                            <span>OR</span>
                        </div>

                        <!-- ZONE DROPDOWN -->
                        <div class="weone-filter-item">
                            <label for="zone" i18n>Zone</label>
                            <p-select
                                inputId="zone"
                                [options]="zones()"
                                placeholder="Select Zone"
                                i18n-placeholder
                                optionLabel="name"
                                [(ngModel)]="selectedZone"
                                (onChange)="onZoneChange($event)"
                                [style]="{ width: '100%' }"
                                [loading]="zonesLoading()"
                                [disabled]="areDropdownsDisabled()"
                                appendTo="body"
                            />

                            @if (bulkSelectionLevel() === 'zone') {
                                <div class="weone-selection-active-inline">
                                    <span
                                        >{{ displayedWardCount() }} wards
                                        selected</span
                                    >
                                    <div class="weone-inline-actions">
                                        <p-button
                                            icon="pi pi-shopping-cart"
                                            severity="success"
                                            size="small"
                                            [text]="true"
                                            [title]="'Add to Cart'"
                                            (onClick)="openBulkSponsorDialog()"
                                        />
                                        <p-button
                                            label="Clear"
                                            icon="pi pi-times"
                                            severity="danger"
                                            size="small"
                                            [text]="true"
                                            (onClick)="clearZoneSelection()"
                                        />
                                    </div>
                                </div>
                            } @else {
                                <p-button
                                    label="Select All Wards in Zone"
                                    i18n-label
                                    severity="secondary"
                                    size="small"
                                    [style]="{
                                        marginTop: '8px',
                                        width: '100%'
                                    }"
                                    [disabled]="
                                        !selectedZone() || stateOrZoneSelected()
                                    "
                                    (onClick)="selectAllWardsInZone()"
                                />
                            }
                        </div>

                        <!-- DISTRICT DROPDOWN -->
                        <div class="weone-filter-item">
                            <label for="district" i18n>District</label>
                            <p-select
                                inputId="district"
                                [options]="districts()"
                                placeholder="Select District"
                                i18n-placeholder
                                optionLabel="name"
                                [(ngModel)]="selectedDistrict"
                                (onChange)="onDistrictChange($event)"
                                [disabled]="
                                    !selectedZone() || areDropdownsDisabled()
                                "
                                [loading]="districtsLoading()"
                                [style]="{ width: '100%' }"
                                appendTo="body"
                            />

                            @if (bulkSelectionLevel() === 'district') {
                                <div class="weone-selection-active-inline">
                                    <span
                                        >{{ displayedWardCount() }} wards
                                        selected</span
                                    >
                                    <div class="weone-inline-actions">
                                        <p-button
                                            icon="pi pi-shopping-cart"
                                            severity="success"
                                            size="small"
                                            [text]="true"
                                            [title]="'Add to Cart'"
                                            (onClick)="openBulkSponsorDialog()"
                                        />
                                        <p-button
                                            label="Clear"
                                            icon="pi pi-times"
                                            severity="danger"
                                            size="small"
                                            [text]="true"
                                            (onClick)="clearDistrictSelection()"
                                        />
                                    </div>
                                </div>
                            } @else {
                                <p-button
                                    label="Select All Wards in District"
                                    i18n-label
                                    severity="secondary"
                                    size="small"
                                    [style]="{
                                        marginTop: '8px',
                                        width: '100%'
                                    }"
                                    [disabled]="
                                        !selectedDistrict() ||
                                        districtOrAboveSelected()
                                    "
                                    (onClick)="selectAllWardsInDistrict()"
                                />
                            }
                        </div>

                        <!-- SUB DISTRICT DROPDOWN -->
                        <div class="weone-filter-item">
                            <label for="subdistrict" i18n>Sub District</label>
                            <p-select
                                inputId="subdistrict"
                                [options]="subDistricts()"
                                placeholder="Select Sub District"
                                i18n-placeholder
                                optionLabel="name"
                                [(ngModel)]="selectedSubdistrict"
                                (onChange)="onSubdistrictChange($event)"
                                [disabled]="
                                    !selectedDistrict() ||
                                    areDropdownsDisabled()
                                "
                                [loading]="subdistrictsLoading()"
                                [style]="{ width: '100%' }"
                                appendTo="body"
                            />

                            @if (bulkSelectionLevel() === 'subdistrict') {
                                <div class="weone-selection-active-inline">
                                    <span
                                        >{{ displayedWardCount() }} wards
                                        selected</span
                                    >
                                    <div class="weone-inline-actions">
                                        <p-button
                                            icon="pi pi-shopping-cart"
                                            severity="success"
                                            size="small"
                                            [text]="true"
                                            [title]="'Add to Cart'"
                                            (onClick)="openBulkSponsorDialog()"
                                        />
                                        <p-button
                                            label="Clear"
                                            icon="pi pi-times"
                                            severity="danger"
                                            size="small"
                                            [text]="true"
                                            (onClick)="
                                                clearSubdistrictSelection()
                                            "
                                        />
                                    </div>
                                </div>
                            } @else {
                                <p-button
                                    label="Select All Wards in Sub District"
                                    i18n-label
                                    severity="secondary"
                                    size="small"
                                    [style]="{
                                        marginTop: '8px',
                                        width: '100%'
                                    }"
                                    [disabled]="
                                        !selectedSubdistrict() ||
                                        wardsLoading() ||
                                        areDropdownsDisabled()
                                    "
                                    (onClick)="selectAllWardsInSubdistrict()"
                                />
                            }
                        </div>
                        <!-- LOCAL BODY TYPE FILTER -->
                        <div class="weone-filter-item">
                            <label for="localBodyType" i18n
                                >Filter by Type</label
                            >
                            <p-select
                                inputId="localBodyType"
                                [options]="localBodyTypeOptions()"
                                [(ngModel)]="selectedLocalBodyType"
                                (onChange)="onLocalBodyTypeChange()"
                                [disabled]="
                                    !selectedSubdistrict() ||
                                    areDropdownsDisabled()
                                "
                                [style]="{ width: '100%' }"
                                appendTo="body"
                            />
                            @if (bulkSelectionLevel() === 'type') {
                                <div class="weone-selection-active-inline">
                                    <span
                                        >{{ displayedWardCount() }} wards
                                        selected</span
                                    >
                                    <div class="weone-inline-actions">
                                        <p-button
                                            icon="pi pi-shopping-cart"
                                            severity="success"
                                            size="small"
                                            [text]="true"
                                            [title]="'Add to Cart'"
                                            (onClick)="openBulkSponsorDialog()"
                                        />
                                        <p-button
                                            label="Clear"
                                            icon="pi pi-times"
                                            severity="danger"
                                            size="small"
                                            [text]="true"
                                            (onClick)="clearTypeSelection()"
                                        />
                                    </div>
                                </div>
                            } @else {
                                <p-button
                                    [label]="selectAllByTypeLabel()"
                                    severity="secondary"
                                    size="small"
                                    [style]="{
                                        marginTop: '8px',
                                        width: '100%'
                                    }"
                                    [disabled]="
                                        selectedLocalBodyType() === 'All' ||
                                        areDropdownsDisabled()
                                    "
                                    (onClick)="selectAllWardsByType()"
                                />
                            }
                        </div>

                        <!-- LOCAL BODY NAME DROPDOWN -->
                        <div class="weone-filter-item">
                            <label for="localBodyName" i18n
                                >Local Body Name</label
                            >
                            <p-select
                                inputId="localBodyName"
                                [options]="convex.localBodies()"
                                placeholder="Select Local Body"
                                i18n-placeholder
                                optionLabel="name"
                                [(ngModel)]="selectedLocalBody"
                                (onChange)="onLocalBodyChange($event)"
                                [disabled]="
                                    !selectedSubdistrict() ||
                                    selectedLocalBodyType() === 'All' ||
                                    convex.localBodiesLoading() ||
                                    areDropdownsDisabled()
                                "
                                [loading]="convex.localBodiesLoading()"
                                [style]="{ width: '100%' }"
                                appendTo="body"
                            />

                            @if (bulkSelectionLevel() === 'localbody') {
                                <div class="weone-selection-active-inline">
                                    <span
                                        >{{ displayedWardCount() }} wards
                                        selected</span
                                    >
                                    <div class="weone-inline-actions">
                                        <p-button
                                            icon="pi pi-shopping-cart"
                                            severity="success"
                                            size="small"
                                            [text]="true"
                                            [title]="'Add to Cart'"
                                            (onClick)="openBulkSponsorDialog()"
                                        />
                                        <p-button
                                            label="Clear"
                                            icon="pi pi-times"
                                            severity="danger"
                                            size="small"
                                            [text]="true"
                                            (onClick)="
                                                clearLocalBodySelection()
                                            "
                                        />
                                    </div>
                                </div>
                            } @else {
                                <p-button
                                    label="Select All Wards in Local Body"
                                    i18n-label
                                    severity="secondary"
                                    size="small"
                                    [style]="{
                                        marginTop: '8px',
                                        width: '100%'
                                    }"
                                    [disabled]="
                                        !selectedLocalBody() ||
                                        areDropdownsDisabled()
                                    "
                                    (onClick)="selectAllWardsInLocalBody()"
                                />
                            }
                        </div>
                    </div>
                </div>

                <div
                    class="weone-bulk-actions"
                    *ngIf="bulkSelectionLevel() || selectedWards().length > 0"
                >
                    <div class="weone-bulk-summary">
                        @if (bulkSponsorshipData()) {
                            <p>
                                Setting sponsorship for
                                <strong
                                    >{{ displayedWardCount() }} wards</strong
                                >
                                at
                                <strong>{{
                                    bulkSponsorshipData()!.level
                                }}</strong>
                                level ({{ bulkSponsorshipData()!.identifier }})
                            </p>
                            <p class="weone-bulk-note">
                                <i class="pi pi-info-circle"></i>
                                {{ estimatedCostDescription() }}
                            </p>
                        } @else {
                            <p>
                                Setting sponsorship for
                                <strong
                                    >{{ selectedWards().length }} selected
                                    wards</strong
                                >. Maximum executives:
                                <strong>{{ bulkMaxExecutives() }}</strong>
                            </p>
                        }
                    </div>
                </div>

                <div class="weone-table-wrapper" appScrollAnimate>
                    <div class="bulk-action-bar flex justify-content-end p-2">
                        <p-button
                            label="Add Selected Wards to Cart"
                            icon="pi pi-cart-plus"
                            severity="success"
                            [disabled]="selectedWards().length === 0"
                            (onClick)="openBulkSponsorDialog()"
                        />
                    </div>
                    <div style="overflow-x: auto">
                        <p-table
                            [value]="filteredWards()"
                            [loading]="wardsLoading()"
                            selectionMode="multiple"
                            [(selection)]="selectedWards"
                            (selectionChange)="onSelectionChange()"
                            dataKey="_id"
                            styleClass="weone-wards-table"
                            [paginator]="true"
                            [rows]="10"
                            [showCurrentPageReport]="true"
                            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} wards"
                            i18n-currentPageReportTemplate
                        >
                            <ng-template pTemplate="header">
                                <tr>
                                    <th colspan="6">
                                        <div class="p-input-icon-left w-full">
                                            <i class="pi pi-search"></i>
                                            <input
                                                pInputText
                                                type="text"
                                                [ngModel]="searchText()"
                                                (ngModelChange)="
                                                    searchText.set($event)
                                                "
                                                placeholder="Search by Ward or Local Body..."
                                                i18n-placeholder
                                                class="w-full"
                                            />
                                        </div>
                                    </th>
                                </tr>
                                <tr>
                                    <th style="width: 4rem">
                                        <p-tableHeaderCheckbox />
                                    </th>
                                    <th i18n>Ward Name</th>
                                    <th i18n>Type</th>
                                    <th i18n>Local Body</th>
                                    <th i18n>Max Executives</th>
                                    <th i18n>Action</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-ward>
                                <tr>
                                    <td><p-tableCheckbox [value]="ward" /></td>
                                    <td>{{ ward.wardName }}</td>
                                    <td>{{ ward.type }}</td>
                                    <td>
                                        {{
                                            getLocalBodyTypeLabel(
                                                ward.localBodyType
                                            )
                                        }}
                                    </td>
                                    <td>
                                        <strong>{{
                                            getMaxExecutives(ward.localBodyType)
                                        }}</strong>
                                        &nbsp;<small i18n>Executive(s)</small>
                                    </td>
                                    <td>
                                        <p-button
                                            label="Add to cart"
                                            i18n-label
                                            icon="pi pi-heart"
                                            size="small"
                                            (onClick)="
                                                openVolunteerDialog(ward)
                                            "
                                        />
                                    </td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="6">
                                        <div class="weone-empty-state">
                                            <i class="pi pi-inbox"></i>
                                            <p i18n>
                                                Please select zone, district,
                                                and sub district to view
                                                available wards
                                            </p>
                                        </div>
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>

            <div class="weone-tool-sidebar">
                @if (cartMessage()) {
                    <div
                        class="weone-cart-intimation"
                        appScrollAnimate
                        [animationDelay]="0"
                    >
                        <i class="pi pi-info-circle"></i>
                        {{ cartMessage() }}
                    </div>
                }

                <div class="weone-sidebar-card" appScrollAnimate>
                    <h4 i18n>Your Details</h4>
                    <div class="weone-form-group">
                        <label i18n>Sponsoring as</label>
                        <p-selectButton
                            [options]="sponsorTypeOptions()"
                            [(ngModel)]="sponsorType"
                            optionLabel="label"
                            optionValue="value"
                        />
                    </div>
                    <div class="weone-form-group">
                        <label for="sponsorName">{{
                            sponsorType() === 'company'
                                ? 'Company Name'
                                : 'Full Name'
                        }}</label>
                        <input
                            id="sponsorName"
                            type="text"
                            pInputText
                            [(ngModel)]="sponsorName"
                            placeholder="Enter your name"
                            i18n-placeholder
                            [style]="{ width: '100%' }"
                        />
                    </div>
                    <div class="weone-form-group">
                        <label for="sponsorEmail" i18n>Email Address</label>
                        <input
                            id="sponsorEmail"
                            type="email"
                            pInputText
                            [(ngModel)]="sponsorEmail"
                            placeholder="your@email.com"
                            i18n-placeholder
                            [style]="{ width: '100%' }"
                        />
                    </div>
                </div>

                <div
                    class="weone-sidebar-card weone-cart-card"
                    appScrollAnimate
                    [animationDelay]="100"
                >
                    <h4 i18n>
                        <i class="pi pi-shopping-cart"></i> Sponsorship Cart
                    </h4>

                    @if (cartItems().length === 0) {
                        <div class="weone-empty-cart">
                            <i class="pi pi-shopping-bag"></i>
                            <p i18n>Your cart is empty</p>
                            <small i18n>Select wards to sponsor</small>
                        </div>
                    } @else {
                        <div class="weone-cart-item-list-container">
                            <div
                                class="weone-cart-item"
                                *ngFor="let item of cartItems()"
                            >
                                <div class="weone-cart-item-details">
                                    <span>{{ item.ward.wardName }}</span>
                                    <small>
                                        Execs: {{ item.executivesSponsored }} |
                                        {{
                                            item.costPerMonth
                                                | currency
                                                    : 'INR'
                                                    : 'symbol'
                                                    : '1.0-0'
                                        }}
                                    </small>
                                </div>
                                <p-button
                                    icon="pi pi-times"
                                    severity="danger"
                                    size="small"
                                    [text]="true"
                                    (onClick)="removeFromCart(item.ward._id)"
                                />
                            </div>
                        </div>

                        <div class="weone-summary-row weone-cart-clear">
                            <p-button
                                label="Clear Cart"
                                icon="pi pi-trash"
                                severity="secondary"
                                [outlined]="true"
                                size="small"
                                (onClick)="clearCart()"
                            />
                        </div>

                        <div class="weone-cart-summary">
                            <div class="weone-summary-row">
                                <span i18n>Total Wards</span>
                                <span>{{ cartItems().length }}</span>
                            </div>
                            <div class="weone-summary-row">
                                <span i18n>Subtotal</span>
                                <span>{{
                                    subtotal()
                                        | currency: 'INR' : 'symbol' : '1.0-0'
                                }}</span>
                            </div>
                            <div class="weone-summary-row">
                                <span i18n>GST (18%)</span>
                                <span>{{
                                    gst() | currency: 'INR' : 'symbol' : '1.0-0'
                                }}</span>
                            </div>
                            <div class="weone-summary-row weone-summary-total">
                                <span i18n>Total</span>
                                <span>{{
                                    total()
                                        | currency: 'INR' : 'symbol' : '1.0-0'
                                }}</span>
                            </div>
                            <div class="weone-summary-bonus">
                                <i class="pi pi-gift"></i>
                                <div class="weone-bonus-details">
                                    <strong i18n>Wallet Bonus</strong>
                                    <span>{{
                                        walletBonus()
                                            | currency
                                                : 'INR'
                                                : 'symbol'
                                                : '1.0-0'
                                    }}</span>
                                </div>
                            </div>
                        </div>
                    }

                    <p-button
                        label="Proceed to Payment"
                        i18n-label
                        icon="pi pi-lock"
                        [disabled]="!isFormValid()"
                        (onClick)="proceedToPayment()"
                        [style]="{ width: '100%' }"
                        styleClass="weone-checkout-btn"
                    />
                </div>
            </div>
        </div>
    </div>
</section>

<p-dialog
    [header]="'Sponsor ' + selectedWardForSponsorship()?.wardName"
    [(visible)]="isVolunteerDialogVisible"
    [modal]="true"
    [draggable]="false"
    [resizable]="false"
>
    <div class="weone-dialog-content">
        <!-- ✅ SIMPLE: Just show if currently sponsored -->
        @if (selectedWardForSponsorship()?.isSponsored) {
            <div class="p-message p-message-warn" style="margin-bottom: 1rem">
                <div class="p-message-wrapper">
                    <span
                        class="p-message-icon pi pi-exclamation-triangle"
                    ></span>
                    <div class="p-message-text">
                        This ward is currently sponsored until
                        <strong>{{
                            selectedWardForSponsorship()?.sponsoredUntil
                                | date: 'mediumDate'
                        }}</strong
                        >. Your sponsorship will start after this date.
                    </div>
                </div>
            </div>
        }

        <div class="weone-ward-summary">
            <div class="weone-ward-summary-item">
                <span class="weone-label">Local Body Type:</span>
                <span class="weone-badge weone-badge-lsgd">{{
                    getLocalBodyTypeLabel(
                        selectedWardForSponsorship()?.localBodyType!
                    )
                }}</span>
            </div>
            <div class="weone-ward-summary-item">
                <span class="weone-label">Max Executives:</span>
                <span class="weone-value">{{ maxExecutives() }}</span>
            </div>
        </div>

        <div class="weone-dialog-form">
            <div class="weone-form-group">
                <label for="executiveCount"
                    >Number of Executives to Sponsor</label
                >
                <p-inputNumber
                    inputId="executiveCount"
                    [(ngModel)]="sponsoredExecutivesCount"
                    [min]="1"
                    [max]="maxExecutives()"
                    [showButtons]="true"
                    buttonLayout="horizontal"
                    incrementButtonIcon="pi pi-plus"
                    decrementButtonIcon="pi pi-minus"
                />
            </div>

            <div class="weone-date-picker-group">
                <div class="weone-form-group">
                    <label for="startDate">Sponsorship Start Date</label>
                    <p-datePicker
                        inputId="startDate"
                        [(ngModel)]="sponsorshipStartDate"
                        [minDate]="today"
                        dateFormat="dd/mm/yy"
                        appendTo="body"
                        [readonlyInput]="
                            selectedWardForSponsorship()?.isSponsored
                        "
                    />
                    @if (selectedWardForSponsorship()?.isSponsored) {
                        <small class="text-blue-600">
                            <i class="pi pi-info-circle"></i>
                            Auto-set to day after current sponsorship ends
                        </small>
                    }
                </div>

                <div class="weone-form-group">
                    <label for="durationMonths">Duration (Months)</label>
                    <p-inputNumber
                        inputId="durationMonths"
                        [(ngModel)]="sponsorshipMonths"
                        [min]="1"
                        [max]="24"
                        [showButtons]="true"
                        buttonLayout="horizontal"
                        [disabled]="sponsorshipStartDate() === null"
                    />
                </div>
            </div>

            <div class="weone-form-group">
                <label>Sponsorship Ends On:</label>
                <span class="weone-value">{{
                    sponsorshipEndDate() | date: 'mediumDate'
                }}</span>
            </div>
        </div>
    </div>

    <ng-template pTemplate="footer">
        <p-button
            label="Cancel"
            severity="secondary"
            [outlined]="true"
            (onClick)="isVolunteerDialogVisible.set(false)"
        />
        <p-button
            [label]="
                selectedWardForSponsorship()?.isSponsored
                    ? 'Queue Sponsorship'
                    : 'Add to Cart'
            "
            icon="pi pi-shopping-cart"
            (onClick)="addToCart()"
            [disabled]="!sponsorshipStartDate() || !sponsorshipEndDate()"
        />
    </ng-template>
</p-dialog>
<p-dialog
    header="Sponsor Multiple Wards"
    [(visible)]="isBulkSponsorDialogVisible"
    [modal]="true"
    [draggable]="false"
    [resizable]="false"
    [style]="{ width: '90vw', maxWidth: '500px' }"
>
    <div class="weone-dialog-content">
        <div class="weone-bulk-summary">
            @if (bulkSponsorshipData()) {
                <!-- Bulk selection at higher level -->
                <p>
                    Sponsoring
                    <strong>{{ displayedWardCount() }} wards</strong> at
                    <strong>{{ bulkSponsorshipData()!.level }}</strong> level in
                    <strong>{{ bulkSponsorshipData()!.identifier }}</strong
                    >.
                </p>
                <p class="weone-bulk-note">
                    <i class="pi pi-info-circle"></i>
                    {{ estimatedCostDescription() }}
                </p>
            } @else {
                <!-- Individual ward selection -->
                <p>
                    You have selected
                    <strong>{{ selectedWards().length }} ward(s)</strong> to
                    sponsor. Maximum executives allowed:
                    <strong>{{ bulkMaxExecutives() }}</strong
                    >.
                </p>
            }
        </div>

        <!-- ✅ SIMPLE: Just show if any are queued -->
        @if (hasQueuedWardsInSelection()) {
            <div class="p-message p-message-info" style="margin-top: 1rem">
                <div class="p-message-wrapper">
                    <span class="p-message-icon pi pi-clock"></span>
                    <div class="p-message-text">
                        Some selected wards are currently sponsored. Your
                        sponsorship for these wards will start after their
                        current sponsorship ends.
                    </div>
                </div>
            </div>
        }

        <div class="weone-dialog-form">
            <div class="weone-form-group">
                <label for="bulkExecutiveCount"> Executives per Ward </label>
                <p-inputNumber
                    inputId="bulkExecutiveCount"
                    [(ngModel)]="bulkSponsoredExecutivesCount"
                    [min]="1"
                    [max]="bulkMaxExecutives()"
                    [showButtons]="true"
                    buttonLayout="horizontal"
                    incrementButtonIcon="pi pi-plus"
                    decrementButtonIcon="pi pi-minus"
                />
            </div>

            <div class="weone-date-picker-group">
                <div class="weone-form-group">
                    <label for="bulkStartDate">Start Date</label>
                    <p-datePicker
                        inputId="bulkStartDate"
                        [(ngModel)]="bulkSponsorshipStartDate"
                        [minDate]="today"
                        dateFormat="dd/mm/yy"
                        appendTo="body"
                    />
                </div>

                <div class="weone-form-group">
                    <label for="bulkDurationMonths">Duration (Months)</label>
                    <p-inputNumber
                        inputId="bulkDurationMonths"
                        [(ngModel)]="bulkSponsorshipMonths"
                        [min]="1"
                        [max]="24"
                        [showButtons]="true"
                        buttonLayout="horizontal"
                        [disabled]="bulkSponsorshipStartDate() === null"
                    />
                </div>
            </div>

            <div class="weone-form-group">
                <label>Ends On:</label>
                <span class="weone-value">{{
                    bulkSponsorshipEndDate() | date: 'mediumDate'
                }}</span>
            </div>
        </div>
    </div>

    <ng-template pTemplate="footer">
        <p-button
            label="Cancel"
            severity="secondary"
            [outlined]="true"
            (onClick)="isBulkSponsorDialogVisible.set(false)"
        />
        <p-button
            label="Add to Cart"
            icon="pi pi-shopping-cart"
            (onClick)="addSelectedWardsToCart()"
            [disabled]="
                !bulkSponsorshipStartDate() ||
                !bulkSponsorshipEndDate() ||
                bulkSponsoredExecutivesCount() > bulkMaxExecutives()
            "
        />
    </ng-template>
</p-dialog>
